# JSONL Viewer 요구사항 명세서 (현재 구현 상황 반영)

## 1. 프로젝트 개요

### 목적
Remote JSONL 파일을 손쉽게 탐색하고 분석할 수 있는 웹 기반 UI 환경 구축

### 배경
- JSONL 파일의 필드가 많고 복잡함
- 마크다운 형식이나 긴 코드가 포함된 텍스트 데이터 처리 필요
- Excel과 같은 고급 데이터 분석 기능 요구
- 효율적인 데이터 탐색 및 필터링 환경 필요

## 2. 기능 요구사항

### 2.1 핵심 기능 (Must Have)

#### A. 파일 로딩 ✅ 구현완료
- **JSONL 파일 업로드**: 로컬 파일 업로드 지원 (최대 10GB)
- **파일시스템 탐색**: 디렉토리 브라우징 및 파일 선택 ✅ 완료
- **Remote URL 로딩**: HTTP/HTTPS URL을 통한 원격 JSONL 파일 로드
- **스트리밍 헤더 분석**: 파일 시작 부분만 읽어 스키마 감지
- **최소 메타데이터 생성**: 
  - 파일 크기, 예상 레코드 수
  - 컬럼 구조 및 타입 (샘플 기반)
  - 기본 파일 정보만 사전 계산
- **빠른 미리보기**: 첫 1000-10000개 레코드로 즉시 표시
- **백그라운드 인덱싱**: 검색을 위한 최소한의 인덱스만 구축

#### B. 데이터 표시 및 탐색 ✅ 부분완료
- **서버사이드 페이지네이션**: 백엔드에서 데이터 청크 단위 제공
- **컬럼 관리**: 크기 조절, 숨김/표시, 순서 변경 ⭐ 신규 완료
- **컬럼 선택기**: 드래그앤드롭 순서 변경, 체크박스 가시성 제어 ⭐ 신규 완료
- **가상 스크롤링**: 클라이언트 사이드 렌더링 최적화
- **행 선택**: 단일/다중 행 선택 (현재 페이지 내)
- **점진적 로딩**: 필요한 데이터만 on-demand 로딩
- **캐시 전략**: 자주 접근하는 데이터 클라이언트 캐시
- **오프셋 기반 네비게이션**: 특정 행 번호로 빠른 이동

#### C. Excel 수준의 데이터 조작 📋 예정
- **정렬 기능**:
  - 단일/다중 컬럼 정렬
  - 오름차순/내림차순
  - 텍스트, 숫자, 날짜별 정렬
  - 길이, 빈도 기준 정렬
  
- **필터링 시스템**:
  - 컬럼별 값 필터 (체크박스 형태)
  - 텍스트 필터 (포함, 시작/끝, 정확히 일치, 정규식)
  - 숫자 필터 (같음, 범위, 상위/하위 N개, 평균 이상/이하)
  - 날짜 필터 (오늘, 이번 주/월, 사용자 정의 범위)
  - 복합 필터 (AND/OR 조건)

- **검색 기능**:
  - 전역 검색 (모든 필드 대상)
  - 컬럼별 검색
  - 검색 결과 하이라이팅
  - 정규식 검색 지원

#### D. 긴 텍스트 및 마크다운 처리 📋 예정
- **스마트 미리보기**: 긴 텍스트의 일부만 표시 + 확장 옵션
- **마크다운 렌더링**: 
  - 미리보기 모드 (렌더링된 결과)
  - 소스 모드 (원본 마크다운)
  - 모드 전환 토글
- **코드 하이라이팅**: 코드 블록 문법 강조 표시
- **모달 상세 보기**: 복잡한 내용을 별도 창에서 표시

#### E. 통계 및 분석 (On-Demand) 📋 예정
- **기본 정보** (즉시 제공):
  - 파일 크기, 예상 레코드 수
  - 컬럼 목록 및 감지된 타입
  - 샘플 데이터 미리보기

- **컬럼별 통계** (사용자 요청시):
  - 텍스트: 길이 분포, 단어 수, 자주 사용되는 단어 (샘플 기반)
  - 숫자: 평균, 중앙값, 표준편차, 최대/최소값, 분위수
  - 날짜: 범위, 시간별 분포
  - 공통: Null 비율, 고유값 수 (근사치), 가장 빈번한 값

- **고급 분석** (사용자 요청시):
  - 전체 파일 스캔이 필요한 정확한 통계
  - 컬럼 간 상관관계 분석
  - 데이터 품질 체크 (중복, 누락값 등)
  - 분포 차트 및 시각화

- **점진적 계산**:
  - 분석 진행률 표시
  - 중간 결과 실시간 업데이트
  - 중단 및 재시작 지원
  - 계산된 결과 캐싱

#### F. 내보내기 📋 예정
- **지원 형식**: JSON, JSONL, CSV, Excel, Markdown
- **데이터 선택**: 전체/필터링된/선택된 데이터
- **컬럼 선택**: 내보낼 컬럼 지정
- **옵션**: 통계 포함, 포맷팅, 압축

### 2.2 고급 기능 (Should Have)

#### A. 사용자 인터페이스 🔄 진행중
- **반응형 디자인**: Desktop, Tablet, Mobile 지원
- **다크/라이트 테마**: 사용자 선택 가능
- **키보드 네비게이션**: 화살표 키로 셀 이동
- **컨텍스트 메뉴**: 우클릭 액션 메뉴

#### B. 성능 최적화 📋 예정
- **청크 로딩**: 대용량 파일의 점진적 로딩
- **검색 인덱스**: 빠른 검색을 위한 인덱싱
- **캐싱**: 계산된 통계 및 필터 결과 캐시

#### C. 고급 분석 📋 예정
- **차트 생성**: 컬럼 데이터의 시각화
- **데이터 분포**: 히스토그램, 박스 플롯
- **상관관계 분석**: 숫자 컬럼 간 상관관계

## 3. 기술 요구사항 ✅ 구현완료

### 3.1 백엔드 요구사항 ✅
- **주 언어**: Python ✅
- **웹 프레임워크**: FastAPI ✅
- **설정 관리**: Pydantic-Settings ✅
- **데이터 처리**: 
  - Pandas (소규모 청크 처리)
  - ijson (스트리밍 JSON 파싱)
- **경량 데이터베이스**: SQLite (메타데이터 및 캐시 저장) ✅
- **파일 처리**: 
  - 스트리밍 I/O (aiofiles)
  - 청크 기반 처리
  - 압축 지원 (gzip, bz2)
- **파일시스템**: Pathlib 기반 안전한 탐색 ✅
- **API 문서화**: OpenAPI/Swagger 자동 생성 ✅

### 3.2 프론트엔드 요구사항 ✅
- **프레임워크**: React + TypeScript ✅
- **빌드 도구**: Vite ✅
- **스타일링**: TailwindCSS ✅
- **상태 관리**: Zustand ✅
- **아이콘**: Lucide React ✅
- **HTTP 클라이언트**: Fetch API ✅

### 3.3 성능 요구사항
- **파일 크기**: 최대 10GB JSONL 파일 지원
- **레코드 수**: 수억 개 레코드 처리 (이론적 한계 없음)

- **즉시 기능** (1-30초 이내):
  - 파일 기본 정보 표시 ✅
  - 스키마 감지 및 컬럼 목록
  - 첫 샘플 데이터 로딩 (1K-10K 레코드)
  - 기본 브라우징 기능 (페이지네이션)

- **백그라운드 기능** (1-10분):
  - 검색 인덱스 구축
  - 기본 메타데이터 생성

- **On-Demand 분석** (요청시):
  - 컬럼별 통계: 1-10분 (크기에 따라)
  - 전체 스캔 작업: 10분-1시간 (크기에 따라)
  - 복잡한 분석: 사용자 대기 허용

## 4. 비기능 요구사항

### 4.1 사용성 (Usability)
- **직관적 인터페이스**: Excel 사용자가 쉽게 적응 가능
- **도움말**: 툴팁 및 가이드 제공
- **오류 처리**: 명확한 오류 메시지 및 복구 옵션
- **로딩 상태**: 진행률 표시 및 중간 피드백

### 4.2 접근성 (Accessibility)
- **키보드 네비게이션**: 마우스 없이 모든 기능 사용 가능
- **스크린 리더**: ARIA 라벨 및 역할 정의
- **색상 대비**: WCAG 2.1 AA 수준 준수

### 4.3 호환성 (Compatibility)
- **브라우저**: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- **운영체제**: Windows, macOS, Linux ✅
- **모바일**: iOS Safari 14+, Android Chrome 90+

### 4.4 보안 (Security)
- **파일 업로드**: 크기 및 형식 검증 ✅
- **경로 보안**: 안전한 디렉토리 접근 제어 ✅
- **CORS**: 적절한 CORS 정책 설정 ✅

## 5. 제약사항

### 5.1 기술적 제약
- **파일 형식**: JSONL만 지원 (JSON 배열 형식은 미지원)
- **메모리 제한**: GB 단위 파일로 인한 스트리밍 처리 필수
- **처리 시간**: 대용량 파일의 초기 분석에 수분~수십분 소요
- **동시성**: 대용량 파일 처리 중 시스템 리소스 집약적 사용

### 5.2 보안 제약 ✅ 구현완료
- **파일시스템 접근**: 제한된 디렉토리만 접근 가능
- **시스템 디렉토리**: 위험한 시스템 경로 차단
- **권한 검사**: 읽기 권한 확인 후 접근

## 6. 우선순위 및 개발 단계

### Phase 1: 즉시 사용 가능한 MVP ✅ 거의 완료
1. **파일시스템 탐색** - 디렉토리 브라우징 및 파일 선택 ✅ 완료
2. **API 인프라** - FastAPI 기반 백엔드 구조 ✅ 완료
3. **프론트엔드 기반** - React + TypeScript 환경 ✅ 완료
4. **컬럼 선택 기능** - 필드 가시성 및 순서 제어 ⭐ 신규 완료
5. **스트리밍 파일 로더** - 빠른 헤더 분석 및 스키마 감지 🔄 진행중
6. **기본 데이터 표시** - 샘플 데이터 기반 테이블 뷰 🔄 진행중

### Phase 2: On-Demand 분석 기능 📋 예정
1. **컬럼별 통계 요청** - 사용자가 원하는 컬럼만 분석
2. **고급 필터링** - 타입별 필터 및 복합 조건
3. **정렬 기능** - 컬럼별 정렬 (필요시 스캔)
4. **진행률 표시** - 분석 작업 진행 상황
5. **결과 캐싱** - 계산된 분석 결과 저장

### Phase 3: 고급 기능 및 최적화 📋 계획
1. **전체 파일 분석** - 완전한 통계 및 인덱스
2. **고급 시각화** - 차트 및 분포 그래프
3. **내보내기** - 필터링된 결과 내보내기
4. **설정 저장** - 사용자별 뷰 설정
5. **성능 최적화** - 인덱싱 및 캐싱 개선

## 7. 성공 지표

### 7.1 즉시 기능 지표 (핵심)
- ✅ 파일시스템 탐색 기능 완전 작동
- ✅ API 구조 및 문서화 완료
- ✅ 프론트엔드 기본 구조 완료
- 🔄 10GB 파일의 기본 정보를 30초 이내 표시
- 🔄 첫 데이터 페이지 1분 이내 로딩

### 7.2 현재 달성 지표 ✅
- ✅ 안전한 파일시스템 탐색
- ✅ 크로스 플랫폼 디렉토리 지원
- ✅ JSONL/JSON 파일 필터링
- ✅ API 엔드포인트 구조 완성
- ✅ 타입 안전 프론트엔드 환경

이 요구사항 명세서는 현재 구현 상황을 반영하여 지속적으로 업데이트됩니다.
